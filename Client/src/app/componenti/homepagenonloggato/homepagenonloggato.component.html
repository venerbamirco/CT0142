<div class="container">
    <div class="row row-cols-1 row-cols-md-3">
        <div class="col-md-4">
            <div class="card border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header text-center sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Lista inserzioni in vendita
                </div>
                <ul class="list-group list-group-flush overflow-auto">
                    <li class="list-group-item" *ngFor="let l of libriInVendita">
                        <span *ngFor="let i of inserzioniInVendita">
                            <span *ngIf="i.libro==l.idLibro">
                                <span class="align-middle text-secondary">Libro: {{l.nome}}</span><button type="button" class="btn btn-secondary btn-sm float-right" (click)="setInserzioneInVenditaSelezionata(i.getIdInserzione())"
                            data-dismiss="modal" aria-label="Close" data-toggle="modal" data-target="#visualizzazioneinserzioneinvendita">Dettagli</button>
                        </span>
                        </span>

                    </li>
                    <li class="list-group-item">
                        <button *ngIf="verificaFiltro()" type="button" class="btn btn-block btn-secondary btn-sm float-right" (click)="filtraInserzioni()" data-toggle="modal" data-target="#filtrareinserzioni">Filtra</button>
                        <button *ngIf="!verificaFiltro()" type="button" class="btn btn-block btn-danger btn-sm float-right" (click)="annullaFiltro()">Annulla
                            filtro</button>
                    </li>
                </ul>

            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Aggiornamento dati
                </div>
                <div class="card-body text-secondary">
                    Vuoi aggiornare i dati?
                    <br><br><button type="button" (click)="recuperaDatiAggiornati()" class="btn btn-block btn-secondary btn-sm">Aggiorna dati</button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Login
                </div>
                <div class="card-body text-secondary">
                    Vuoi effettuare il login?
                    <br><br><button type="button" (click)="effettuaLogin()" class="btn btn-block btn-secondary btn-sm">Loggati</button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Registrazione
                </div>
                <div class="card-body text-secondary">
                    Vuoi creare un nuovo account?
                    <br><br><button type="button" (click)="effettuaRegistrazione()" class="btn btn-block btn-secondary btn-sm">Registrati</button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Gestione errori
                </div>
                <div class="card-body">
                    <div *ngIf="dettagliErrore.getMessage()" id="alertnuovoerrore" class="alert alert-secondary alert-dismissible fade show mt-3 ml-3 mr-3" role="alert">
                        <strong>Messaggio: </strong>{{dettagliErrore.getMessage()}}<br>
                        <strong>Reason: </strong>{{dettagliErrore.getReason()}}
                        <button type="button" class="close" aria-label="Close" (click)="dettagliErrore.setMessage('');dettagliErrore.setReason('')">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center border border-secondary altezza-card mt-3" style="width: 100%;">
                <div class="card-header sfondo-grigio-chiaro testo-bianco testo-grassetto">
                    Implementazione futura
                </div>
                <div class="card-body text-secondary">
                    Funzionalita extra
                </div>
            </div>
        </div>
    </div>
</div>
<br>

<!--modal per filtrare le inserzioni-->
<div class="modal fade" id="filtrareinserzioni" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h5 class="modal-title text">Filtraggio inserzione</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form action="#" method="GET">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Nome libro">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="libro" type="text" #inputNomeLibro="ngModel" [(ngModel)]="filtraggioInserzioni.nomeLibro" class="form-control-plaintext text-center border border-secondary" value="" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Corso di studi">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="corsodistudi" type="text" #inputCorsoDiStudi="ngModel" [(ngModel)]="filtraggioInserzioni.corsoDiStudi" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Universita">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="universita" type="text" #inputUniversita="ngModel" [(ngModel)]="filtraggioInserzioni.universita" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Area gerografica">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="areaGeografica" type="text" #inputAreaGeografica="ngModel" [(ngModel)]="filtraggioInserzioni.areaGeografica" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Venditore">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="venditore" type="text" #inputVenditore="ngModel" [(ngModel)]="filtraggioInserzioni.venditore" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Prezzo attuale minimo">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="prezzoMinimo" type="number" #inputPrezzoMinimo="ngModel" [(ngModel)]="filtraggioInserzioni.prezzoAttualeMinimo" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mt-3 text-center">
                            <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Prezzo attuale massimo">
                        </div>
                        <div class="col-md-9 mt-3 text-center">
                            <input name="prezzoMassimo" type="number" #inputPrezzoMassimo="ngModel" [(ngModel)]="filtraggioInserzioni.prezzoAttualeMassimo" class="form-control-plaintext text-center border border-secondary" value="">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger" data-dismiss="modal" aria-label="Close">Annulla</button>
                    <button type="submit" class="btn btn-success" (click)="filtraInserzioni();" (submit)="filtraInserzioni();" data-dismiss="modal" aria-label="Close">Filtra</button>
                </div>
            </form>
        </div>
    </div>
</div>


<!--modal per la visualizzazione di una singola inserzione in vendita e quindi non visibili tutti i parametri al cliente-->
<div class="modal fade" id="visualizzazioneinserzioneinvendita" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h5 class="modal-title text">Visualizzazione inserzione in vendita</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div *ngIf="inserzione" class="modal-body">
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Utente">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="utente" type="text" class="form-control-plaintext text-center border border-secondary" value="{{utente.getUsername()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Libro">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="libro" type="text" class="form-control-plaintext text-center border border-secondary" value="{{libro.getNome()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Corso di studi">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="corsodistudi" type="text" class="form-control-plaintext text-center border border-secondary" value="{{libro.getCorsoDiStudi()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Universita">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="universita" type="text" class="form-control-plaintext text-center border border-secondary" value="{{libro.getUniversita()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Autore">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="autore" type="text" class="form-control-plaintext text-center border border-secondary" value="{{libro.getAutore()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Anno di pubblicazione">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="annodipubblicazione" type="number" class="form-control-plaintext text-center border border-secondary" value="{{libro.getAnnoPubblicazione()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Edizione">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="edizione" type="number" class="form-control-plaintext text-center border border-secondary" value="{{libro.getEdizione()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Isbn">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="isbn" type="text" class="form-control-plaintext text-center border border-secondary" value="{{libro.getIsbn()}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Data inizio">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input *ngIf="inserzione.dataInizio!=undefined" name="datainizio" type="date" class="form-control-plaintext text-center border border-secondary" value="{{inserzione.dataInizio}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Data fine">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input *ngIf="inserzione.dataFine!=undefined" name="datafine" type="date" class="form-control-plaintext text-center border border-secondary" value="{{inserzione.dataFine}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3 mt-3 text-center">
                        <input type="text" readonly class="form-control-plaintext text-center border border-light" value="Prezzo attuale">
                    </div>
                    <div class="col-md-9 mt-3 text-center">
                        <input name="prezzoattuale" type="number" class="form-control-plaintext text-center border border-secondary" value="{{inserzione.getPrezzoAttuale()}}" disabled>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal" aria-label="Close">Esci</button>
                <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#vistachat" (click)="getListaMessaggiInserzioneChatPubblica()">Chat
                    pubblica</button>
            </div>
        </div>
    </div>
</div>

<!--modal per la vista delle chat-->
<div class="modal fade" id="vistachat" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h5 class="modal-title text">Chat con {{destinatarioMessaggiChatSelezionata}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row" *ngFor="let lm of listaMessaggi">
                    <div class="col-1"></div>
                    <div class="col-7 mt-3 alert float-left alert-secondary rounded-lg border border-secondary" role="alert">
                        <div *ngIf="getContenutoMessaggioRiferimento(lm)" style="width: 100%;" class="mt-3 alert float-left alert-light rounded-lg border border-secondary" role="alert">
                            {{getContenutoMessaggioRiferimento(lm).getContenuto()}}
                        </div>
                        <br *ngIf="getContenutoMessaggioRiferimento(lm)">
                        <div *ngIf="getPersonaNellaChat(lm.getMittente())">
                            [{{lm.getDataFormatoStringa()}} {{lm.getOraFormatoStringa()}} {{getPersonaNellaChat(lm.getMittente()).getNome()}}]: {{lm.getContenuto()}}
                        </div>
                    </div>
                    <div class="col-4 mt-3 alert float-left rounded-lg" role="alert">
                        <div>
                            <img style="vertical-align: middle;" src="https://icons555.com/images/icons-black/image_icon_arrow_79_pic_512x512.png" width="30" height="40">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>